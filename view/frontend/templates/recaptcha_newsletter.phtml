<?php
declare(strict_types=1);

/** @var $block \Magento\ReCaptchaUi\Block\ReCaptcha */

/** @var $viewModel \MageSuite\ExtendedRecaptcha\ViewModel\ReCaptcha */
$viewModel = $block->getViewModel();
$recaptchaFor = /* @noEscape */ $block->getRecaptchaFor();
$recaptchaAppendTo = /* @noEscape */ $block->getRecaptchaAppendTo();
$recaptchaName = /* @noEscape */ $block->getRecaptchaName();
$isInvisibleRecaptcha = $viewModel->isInvisibleRecaptcha($recaptchaFor);
?>

<div class="cs-google-recaptcha cs-google-recaptcha--<?= $recaptchaName ?>">
    <div class="field-recaptcha cs-google-recaptcha__badge <?= $isInvisibleRecaptcha ? 'cs-google-recaptcha__badge--invisible' : '';?>" id="<?= /* @noEscape */ $block->getRecaptchaId() ?>-container" data-bind="scope:'<?= /* @noEscape */ $block->getRecaptchaId() ?>'">
        <!-- ko template: getTemplate() --><!-- /ko -->
    </div>
    <?php if ($isInvisibleRecaptcha && $viewModel->isRecaptchaCustomNoteEnabled()): ?>
    <span class="cs-google-recaptcha__note">
        <?= $viewModel->getRecaptchaNote();?>
    </span>
    <?php endif; ?>
</div>

<script>
    require(['jquery', 'domReady!'], function ($) {
        $('.cs-google-recaptcha--<?= $recaptchaName ?>').appendTo('<?= $recaptchaAppendTo ?>').css('display', 'block');
    });
</script>

<script type="text/x-magento-init">
{
    "#<?= /* @noEscape */ $block->getRecaptchaId() ?>-container": {
        "Magento_Ui/js/core/app": <?= /* @noEscape */ $block->getJsLayout() ?>
    }
}
</script>
